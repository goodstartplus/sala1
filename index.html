<!-- Zoom Meeting SDK -->
<script src="https://source.zoom.us/2.14.0/lib/vendor/react.min.js"></script>
<script src="https://source.zoom.us/2.14.0/lib/vendor/react-dom.min.js"></script>
<script src="https://source.zoom.us/2.14.0/lib/vendor/redux.min.js"></script>
<script src="https://source.zoom.us/2.14.0/lib/vendor/redux-thunk.min.js"></script>
<script src="https://source.zoom.us/2.14.0/zoom-meeting-2.14.0.min.js"></script>

<!-- Biblioteca para gerar a assinatura -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/10.5.18/jsrsasign-all-min.js"></script>

<!-- BotÃ£o para entrar na reuniÃ£o -->
<button id="joinMeeting">Entrar na ReuniÃ£o</button>

<script>
  // ğŸ” Credenciais do Zoom
  const apiKey = 'USroBek9TFK0sdTnKGQcg';      // API Key (Client ID)
  const apiSecret = 'xfjGAB6qOuMVQCABv8obRavSaNrd1X8d';  // API Secret
  const meetingNumber = '87370145813';         // ID da ReuniÃ£o
  const passWord = '0fGYcM';                   // Senha da ReuniÃ£o

  // ğŸ“§ Dados do aluno (do Memberkit)
  const userName = 'Nome do Aluno';           // Nome real do aluno
  const userEmail = 'email@dominio.com';      // Email real do aluno

  // âš™ï¸ Inicializar o SDK
  ZoomMtg.preLoadWasm();
  ZoomMtg.prepareJssdk();

  // ğŸ”‘ FunÃ§Ã£o para gerar a assinatura
  function generateSignature(apiKey, apiSecret, meetingNumber, role) {
    const iat = Math.round(new Date().getTime() / 1000) - 30;
    const exp = iat + 60 * 60 * 2;

    const oHeader = { alg: 'HS256', typ: 'JWT' };
    const oPayload = {
      sdkKey: apiKey,
      mn: meetingNumber,
      role: role,
      iat: iat,
      exp: exp,
      appKey: apiKey,
      tokenExp: exp
    };

    const sHeader = JSON.stringify(oHeader);
    const sPayload = JSON.stringify(oPayload);
    const signature = KJUR.jws.JWS.sign('HS256', sHeader, sPayload, apiSecret);

    startMeeting(signature);
  }

  // ğŸšª FunÃ§Ã£o para iniciar a reuniÃ£o
  function startMeeting(signature) {
    ZoomMtg.init({
      leaveUrl: 'https://goodstart.com.br',
      success: function () {
        ZoomMtg.join({
          signature: signature,
          meetingNumber: meetingNumber,
          userName: userName,
          apiKey: apiKey,
          userEmail: userEmail,
          passWord: passWord,
          success: function () {
            console.log('âœ… ReuniÃ£o iniciada com sucesso!');
          },
          error: function (err) {
            console.error('âŒ Erro ao iniciar a reuniÃ£o:', err);
          }
        });
      },
      error: function (err) {
        console.error('âŒ Erro ao inicializar o SDK:', err);
      }
    });
  }

  // ğŸ–±ï¸ Evento do botÃ£o
  document.getElementById('joinMeeting').addEventListener('click', function () {
    generateSignature(apiKey, apiSecret, meetingNumber, 0);  // 0 = Participante
  });
</script>
